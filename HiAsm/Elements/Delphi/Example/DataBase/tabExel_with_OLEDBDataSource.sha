*Пример работы с таблицей Excel через источник данных OLEDB#13#10______________________#13#10Автор: nesco
Make(delphi)
ver(4.04 build 185)
Add(MainForm,3171043,70,168)
{
 Left=20
 Top=105
 Width=390
 Height=415
 Caption="tabExel_with_OLEDBDataSource"
 Position=1
 link(onCreate,11947023:doStrCat,[])
}
Add(Button,941652,273,357)
{
 Left=305
 Top=5
 Width=75
 TabOrder=-1
 Caption="Подключить"
 link(onClick,5366140:doOpen,[])
}
Add(StringTable,6078793,623,329)
{
 Left=5
 Top=165
 Width=375
 Height=210
 Point(doAddColumn)
}
Add(MT_Enum,5673081,567,364)
{
 link(onItem,6078793:doAddColumn,[])
}
Add(MT_String,16321824,567,322)
{
 link(onResult,6078793:doAdd,[(611,328)(611,335)])
}
Add(Edit,11108326,329,168)
{
 Left=5
 Top=5
 Width=295
 Text=""
 link(onChange,7246550:doEvent1,[])
 link(Str,12927216:Var3,[(335,156)(236,156)(236,233)])
}
Add(Dir,5145339,126,133)
{
}
Add(StrCat,11947023,126,182)
{
 Str2="test.xls"
 link(onStrCat,13359086:doFileExists,[])
 link(Str1,5145339:CurrentDir,[])
}
Add(FormatStr,5564056,539,217)
{
 Mask="Driver={Microsoft Excel Driver (*.xls)};\r\nDriverID=22;\r\nDBQ=%1;\r\nDefaultDir=%2;\r\n\r\n"
 Point(FString)
 link(onFString,14216946:doText,[])
 link(Str2,1388409:Value,[])
}
Add(FormatStr,10216816,567,273)
{
 Mask="SELECT * FROM `%1`.`Лист1$` `Лист1$` ORDER BY `Лист1$`.Пункт"
 Point(FString)
 link(onFString,15254124:doText,[])
}
Add(Memo,14216946,623,196)
{
 Left=5
 Top=30
 Width=375
 Height=105
}
Add(DS_OLEDB,5366140,329,357)
{
 Name="ole_driver_1"
 Point(onError)
 link(onCreate,13233332:doQuery,[])
 link(Driver,5564056:FString,[(335,260)(545,260)])
}
Add(DSC_Query,13233332,385,357)
{
 DSManager="ole_driver_1"
 link(onQuery,16321824:doStr,[(468,363)(468,328)])
 link(onColumns,5673081:doEnum,[])
 link(SQL,15254124:Text,[(391,314)(629,314)])
}
Add(Hub,7246550,378,168)
{
 link(onEvent1,12314600:doEvent1,[])
 link(onEvent2,5564056:doString,[(401,181)(401,223)])
}
Add(MemoryStream,8873750,329,70)
{
 Stream=[ZIP0038000078DAED5B6D6C1445187E776FEE6EAF77B4DB2F2C2DD6A3A00245BCBBBDEB5D296DAF7C0898902268C480C152AA103E4A0A261AA29E5F893F34D168626248947F12133F62C4C41002FF2448342A51893FAAC6C43F2A104D3002E733EFCEEDEDB57B488D060CFB6EE6E37DE67DE69D9D999DDD99DC7DF669FDF881F75ABFA309D24701BA548C50C8856908AD25C52494178B325B4A6720147DF95F49C4C0408682F445CBC9F0F1A3C80688BE239DDE15C710137D8FB0917653946860D796B1D19D235B8656AF8BFFE7B284DB30A4C9361CC5C4EBD542987F3A66E57EC4B5986BB2A481E3468EDF61DBC31CF7A2645CABA30D3DBFDC9E537377BD9E67BB1738EEE0B816B1461F32E7342349947C2CE7F1132FCAE94E9FCC8868033446DB688876509C96D2A3D0AE8ED51B7F6BD52E6EA7203593369B16D06C5C09D0F26221E21E0CE36D34196F17DD78C85BBD291B682D8DD016BABF2AB987C2D4E6262F44A8EEB5B2B45D2C27038DBF0CBD5A0B2656B49DE69345DA2618CD478D939B2A4BECD65CAEBCC4EF40DAE15196E758BA9BE7ED6E13289BD0BA6AEE2ACB2BDD4D2E2BB9DB077E8F97BBCA6EA8E6D4CBAAD2753FAEEA77BB8F3A2FE7FEEFEED9CB6AB2FB6A773F4E4DFC04FF5E8CBBDE4547E312D74AF86F5786EB53C4E93AC435F2EAE705B6FDF989F8FC2A78A40ADE59059FE789CBF598DB23CAF8CBBA20B3208A32AD2F8439A50271DA500872DA580870DA5408151FE0D5FD59BC11C622B286A0D6267262402C1149462FD656A229468559895AF43C1A11C6754C3310F00639A2D105FA519B0BBBD908783FDD24968A7EB108945E21486B406689181401D2B0502223EC4C4658224C5A078A178B3EB10C40B708D9F68BC0E81379614835C1C6BD80648D0C0D8A15800650901029496A83DA87D29C484B8B467073A8BF8FD36EE9A7912DF200251024DA35B26778344C944AA6AC74A60B95CC84C1007CA7506B8CA833DB9DCA59894C2A97CDDA6A572667A57350710BADA8270353BE9B3CB23D254E26D395ED4E24B3A8B11E25836896ACD5900E9602588CEA6D085D321B379E9095CC82F315A8D3AE2491B292D974D2B2F0E589EAD2560A99EE442E914D94BC7425B3563A9DB155CBB240CA65711B9443A65B9965BAAC6C36DB9549034F679299EE74D01EA05EEE63F4CB1CB85F0CBF3D0883F68064B8C39771870665CFC97EEB43CF1631D10DBA139D86DAE94858CE38A28441740EE96B4837624A9C47FA11D261A319A1FC1035ABF4740D22FB8BCBACF8E28AEA4D8EF134848530DC5C2BF3F2FB2486780BD571BE9ED72A138DB970F0ECE7AB37AFE9DFC4F87CC63B397E8A9102955B70B37C46A8484FA2E49868524D7A9AAD9FE1F800566169A1F1255C2BC0787F39BD07B6063DC69D40B42AD40C5DB02E59545BD6755CABCCB21EC0B56A9AAD935EEBDCA9FD681BBAA9F245B5D5A8634CF3C0740F2CE081090F2CE881853CB0B007667860110FACC6038B7A60B109D84566CA91B909B1AD69D0E28EA6439BE568016872CC1ED76BB89FE4889EE997651AF348596ACC8B399AE44D533CBD3439F3B24C679EA62C75E6D53A9AE4998A17503C837901E6E9CA32C0BC3A4793BC7AC5138A67324F302FA02C05F31A1CCDDDCEA0E235312FC83CA12C83CCBBC1D1DCBC90E2B5302FC4BCA0B20C31AFC5D124AF51F1C28A37937961E68594659879331CCDDD2F86E2C59967302FAC2C0DE6B53A9ABB9D11C5EB605E847986B28C30AFCDD1DCBC1AC59BC3BC1AE64594650DF3663A9AE435295E54F16E615E947935CA32CABC1B1D4DF29A152FA678739917635E5459C698D7EE6892371DDA57C0BEC5209FA15C95AB4F6FA0437CD09077AD3B37620E05ECC75D430723A7FF8A41085216C843462342D938C0D396B61AB722B861F54923546A2F4C52ABBE149B1507211FD45DCD6538E0B50CEBF6325C5A465D8736B223C9B323CB273852CA1D79A5DD70D8BCE6DE46FF76375C9772A928BF72F549B8ECA2F1675F3FF7C7E056F3AD970CEABCF5FD6F12C0DE4408ABF2BC7A7BAF946F023E27225EBF7793FD99F49C7AC7BFC26734C4E717D2D30F20B52B1BD7A152554CCEC4D5DB86C746F78C3EB837BEFC91E1911DF6C89EFEF9AECE83C735992FACBC705F02F900F9E28B2FBEF8E28B2FBEF8E28B2FBEF8E28B2F53D9FFEBA74E9EDABFB0CD7CF955ECFF17FCF1B6DCFF7F891051E56B10E439EF7A0479FEBA1521AAF6FF72CFFE88DAF71710A6BBCE035E54FBFC4313CE03E419C2DD233B46B68FEEE4939AAF5BA25C1FA97ABDD276D33EE593C787277E3A7B2EE9E4524ECEA298697B6A7759FEC93CFFBCC0175F7CF1C5175F7CF1C5175F7CF1C597EB4134B507B77F4147FCEB28B9430EABFDB8FC6F4F8DDA6FC7D4FEBD56EDFB4D55DEA0F6F9A55F724C57E7012DAAFC22C225FFAF36D7A4ACA5515C7B294ECB6917D2317A744AF3673A05B5525D721EC50DFB2CE9A85D7C87DB76CD86AD27AC83C7B5D2FFC5A4DC0BEF63B49D36733BB64F79FE3690AEB9EFE74A79D17A3B0DD23A7A9876E21AE27B5F855E7890DB2491BDB40DF95D97A9672EFC6BEAF9B952FFFC3374B3E47F193C0C731B467804A6D69EDC3FB8FF7A97FFBF003DC7E067]
}
Add(FileStream,7287210,378,105)
{
 Mode=1
 AutoCopy=0
 Point(doCopyFromStream)
 link(FileName,12927216:Var1,[(384,64)(57,64)(57,233)])
}
Add(FileTools,13359086,175,161)
{
 link(onEnd,6019363:doEvent,[])
}
Add(IndexToChanel,6019363,224,161)
{
 link(onEvent1,1529848:doEvent1,[(268,167)(268,125)])
 link(onEvent2,1629790:doWork2,[])
}
Add(DoData,15940094,329,119)
{
 link(onEventData,7287210:doCopyFromStream,[])
 link(Data,8873750:Stream,[])
}
Add(Hub,1529848,280,119)
{
 link(onEvent1,15940094:doData,[])
 link(onEvent2,1629790:doWork1,[(305,132)])
}
Add(HubEx,1629790,301,168)
{
 link(onEvent,11108326:doText,[])
}
Add(GetDataEx,12927216,126,228)
{
 link(Data,11947023:Result,[])
}
Add(Edit,15254124,623,273)
{
 Left=5
 Top=140
 Width=375
 Text=""
}
Add(Memory,1388409,546,168)
{
}
Add(FilePartElm,3189965,469,273)
{
 Mode=2
 link(onPart,10216816:doString,[])
}
Add(FilePartElm,8180295,469,168)
{
 Mode=0
 link(onPart,1388409:doValue,[])
}
Add(Hub,12314600,427,168)
{
 link(onEvent1,8180295:doPart,[])
 link(onEvent2,3189965:doPart,[(455,181)(455,279)])
}
